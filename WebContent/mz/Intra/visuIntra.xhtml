<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.org/schema/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:p="http://java.sun.com/jsf/html">

	<rich:tabPanel switchType="client" activeItem="pageDefaut">
		<rich:tab header="Récapitulatif de la demande"
			onheaderclick="changePage('page1')">
			<rich:panel header="Information intra">
				<table border="0" cellspacing="3">
					<tr>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:400px;">
								<ui:define name="label">
									<h:outputText value="#{messages['prospect.dateCreation']}" />
								</ui:define>
								<h:outputText value="#{intraManager.intra.dateCreation}" />
							</s:decorate></td>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:400px;">
								<ui:define name="label">
									<h:outputText value="#{messages['prospect.nomEntreprise']}" />
								</ui:define>
								<h:outputText value="#{intraManager.intra.prospect.societe}" />
							</s:decorate></td>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:400px;">
								<ui:define name="label">
									<h:outputText value="#{messages['devis.contactClient']}" />
								</ui:define>
								<h:outputText value="#{intraManager.intra.prospect.nom}" />
							</s:decorate></td>
					</tr>
					<tr>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:400px;">
								<ui:define name="label">
									<h:outputText value="#{messages['prospect.commerciale']}" />
								</ui:define>
								<h:outputText
									value="#{intraManager.intra.prospect.prospectDetail.commercial}" />
							</s:decorate></td>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:400px;">
								<ui:define name="label">
									<h:outputText value="Prob. transformation" />
								</ui:define>
								<h:outputText value="#{intraManager.intra.probTransformation}" />
							</s:decorate></td>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:400px;">
								<ui:define name="label">
									<h:outputText value="#{messages['intra.duree']}" />
								</ui:define>
								<h:outputText value="#{intraManager.intra.duree}" />
							</s:decorate></td>
					</tr>
					<tr>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:400px;">
								<ui:define name="label">
									<h:outputText value="#{messages['prospect.lieu']}" />
								</ui:define>
								<h:outputText
									value="#{intraManager.intra.prospect.prospectDetail.lieu}" />
							</s:decorate></td>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:400px;"
								rendered="#{!empty intraManager.intra.prospect.ville}">
								<ui:define name="label">
									<h:outputText value="#{messages['prospect.ville']}" />
								</ui:define>
								<h:outputText value="#{intraManager.intra.prospect.ville}" />
							</s:decorate></td>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:400px;">
								<ui:define name="label">
									<h:outputText value="#{messages['prospect.participant']}" />
								</ui:define>
								<h:outputText
									value="#{intraManager.intra.prospect.prospectDetail.nb_participants}" />
							</s:decorate></td>
					</tr>
					<tr>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:400px;">
								<ui:define name="label">
									<h:outputText value="#{messages['prospect.dateSouhait']}" />
								</ui:define>
								<h:outputText
									value="#{intraManager.intra.prospect.prospectDetail.date_souhaite}" />
							</s:decorate></td>
					</tr>
				</table>
			</rich:panel>
			<rich:collapsiblePanel header="Note Perso : cliquez ici pour voir"
				expanded="true" switchType="client"
				rendered="#{!empty intraManager.intra.prospect.notePerso}">
				<center>
					<rich:dataTable value="#{intraManager.messages}" var="message"
						rowKeyVar="index">
						<rich:column>
							<f:facet name="header">
								<h:outputText value="Message n°" />
							</f:facet>
							<center>
								<h:outputText value="#{index+1}" />
							</center>
							<f:facet name="footer">
								<h:outputText value="Message n°" />
							</f:facet>
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{messages['historique.date']}" />
							</f:facet>
							<h:outputText value="#{message.date}">
								<s:convertDateTime type="both" />
							</h:outputText>
							<f:facet name="footer">
								<h:outputText value="#{messages['historique.date']}" />
							</f:facet>
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{messages['message.emetteur']}" />
							</f:facet>
							<h:outputText value="#{message.account.nomComplet}" />
							<f:facet name="footer">
								<h:outputText value="#{messages['message.emetteur']}" />
							</f:facet>
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText
									value="#{messages['historique.FormationCommentEvent']}" />
							</f:facet>
							<h:outputText value="#{message.libelle}" />
							<f:facet name="footer">
								<h:outputText
									value="#{messages['historique.FormationCommentEvent']}" />
							</f:facet>
						</rich:column>
					</rich:dataTable>
				</center>
			</rich:collapsiblePanel>
		</rich:tab>
		<rich:tab header="Environnement technique"
			onheaderclick="changePage('page2')">
			<table border="0" cellspacing="3">
				<tr>
					<td><s:decorate template="../layout/display.xhtml"
							style="width:500px;">
							<ui:define name="label">
								<h:outputText value="Profil des participants" />
							</ui:define>
							<h:outputText value="#{intraManager.intra.profilParticipant}" />
						</s:decorate></td>
					<td><s:decorate template="../layout/display.xhtml"
							style="width:500px;">
							<ui:define name="label">
								<h:outputText value="Les pax disposent-ils des pré-requis ?" />
							</ui:define>
							<h:outputText value="#{intraManager.intra.preRequis}" />
						</s:decorate></td>
				</tr>
				<tr>
					<td><s:decorate template="../layout/display.xhtml"
							style="width:500px;">
							<ui:define name="label">
								<h:outputText value="Connaissance sujet" />
							</ui:define>
							<h:outputText value="#{intraManager.intra.connaissanceSujet}" />
						</s:decorate></td>
					<td><s:decorate template="../layout/display.xhtml"
							style="width:500px;">
							<ui:define name="label">
								<h:outputText value="Objectif" />
							</ui:define>
							<h:outputText value="#{intraManager.intra.objectif}" />
						</s:decorate></td>
				</tr>
				<tr>
					<td><s:decorate template="../layout/display.xhtml"
							style="width:500px;">
							<ui:define name="label">
								<h:outputText value="Contact tech." />
							</ui:define>
							<h:outputText
								value="#{intraManager.intra.coordonneesContactTech}" />
						</s:decorate></td>
				</tr>
			</table>
		</rich:tab>
		<rich:tab header="Formation(s) / Intervenant(s)"
			onheaderclick="changePage('page3')" id="pageDefaut">
			<rich:panel header="Etat de l'intra">
				<table border="0" cellspacing="3">
					<tr>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:400px;">
								<ui:define name="label">
									<h:outputText value="#{messages['intra.statut']}" />
								</ui:define>
								<h:outputText
									value="#{messages[intraManager.intra.statutIntra]}" />
							</s:decorate></td>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:400px;">
								<ui:define name="label">
									<h:outputText value="Valider" />
								</ui:define>
								<h:outputText value="Oui"
									rendered="#{intraManager.intra.valide == 1}" />
								<h:outputText value="Non"
									rendered="#{intraManager.intra.valide == 0}" />
							</s:decorate></td>
					</tr>
					<tr>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:500px;">
								<ui:define name="label">Certification ?</ui:define>
								<h:outputText value="#{intraManager.intra.certification}" />
							</s:decorate></td>
					</tr>
					<tr>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:500px;">
								<ui:define name="label">
									<h:outputText value="Quel Format ?" />
								</ui:define>
								<h:outputText value="#{intraManager.intra.format}" />
							</s:decorate></td>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:500px;">
								<ui:define name="label">
									<h:outputText value="Montant Frais Jours" />
								</ui:define>
								<h:outputText value="#{intraManager.intra.montantFrais}"
									rendered="#{!empty intraManager.intra.montantFrais}">
									<f:convertNumber currencySymbol="€" type="currency" locale="FR" />
								</h:outputText>
								<h:outputText value="N/C"
									rendered="#{empty intraManager.intra.montantFrais}" />
							</s:decorate></td>
					</tr>
				</table>
			</rich:panel>
			<br />
			<br />
			<rich:panel header="Tableau Récapitulatif">
				<center>
					<rich:dataTable value="#{intraManager.intra.prospect.formations}"
						var="formation" rowKeyVar="index" style="width:1250px">
						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{messages['prospect.nomEntreprise']}" />
							</f:facet>
							<h:outputText value="#{intraManager.intra.prospect.societe}" />
						</rich:column>

						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{messages['prospect.com']}" />
							</f:facet>
							<h:outputText
								value="#{intraManager.intra.prospect.prospectDetail.commercial}" />
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="Durée en jour" />
							</f:facet>
							<h:outputText value="#{formation.formation.duree}" />
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="Durée souhaitée" />
							</f:facet>
							<h:outputText value="#{formation.dureeVoulu}" />
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="Dates souhaitées" />
							</f:facet>
							<center>
								<h:outputText value="#{formation.session}" style="width:120px" />
							</center>
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{messages['prospect.reference']}" />
							</f:facet>
							<h:outputText value="#{formation.formation.reference}" />
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{messages['prospect.libelleFormation']}" />
							</f:facet>
							<h:outputText value="#{formation.formation.libelle}" />
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="Nb part." />
							</f:facet>
							<center>
								<h:outputText value="#{formation.participant}"
									style="width:30px" />
							</center>
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{messages['prospect.lieu']}" />
							</f:facet>
							<h:outputText
								value="#{intraManager.intra.prospect.prospectDetail.lieu}"
								rendered="#{empty intraManager.intra.prospect.ville}" />
							<h:outputText value="#{intraManager.intra.prospect.ville}"
								rendered="#{!empty intraManager.intra.prospect.ville}" />
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="Intervenant(s)" />
							</f:facet>
							<center>
								<rich:dataTable value="#{formation.intervenants}"
									var="intervenant" rowKeyVar="index" style="width:300px">
									<rich:column>
										<f:facet name="header">
											<h:outputText value="Nom - Prénom" />
										</f:facet>
										<h:outputText
											value="#{intervenant.intervenant.nom} - #{intervenant.intervenant.prenom}" />
									</rich:column>
									<rich:column>
										<f:facet name="header">
											<h:outputText value="Tarif" />
										</f:facet>
										<h:outputText value="#{intervenant.tarif}">
											<f:convertNumber currencySymbol="€" type="currency"
												locale="FR" />
										</h:outputText>
									</rich:column>
									<rich:column>
										<f:facet name="header">
											<h:outputText value="Note" />
										</f:facet>
										<h:outputText value="#{intervenant.note}" />
									</rich:column>
									<rich:column>
										<f:facet name="header">
											<h:outputText value="Retenu" />
										</f:facet>
										<center>
											<h:outputText value="Oui"
												rendered="#{intervenant.favori == 1}" />
											<h:outputText value="Non"
												rendered="#{intervenant.favori == 0}" />
										</center>
									</rich:column>
								</rich:dataTable>
							</center>
						</rich:column>
					</rich:dataTable>
					<a:outputPanel
						rendered="#{!empty intraManager.intra.intraReferenceSpe}">
						<rich:dataTable value="#{intraManager.intra.intraReferenceSpe}"
							var="intraReferenceSpe" rowKeyVar="index" style="width:1250px">
							<rich:column>
								<f:facet name="header">
									<h:outputText value="#{messages['prospect.nomEntreprise']}" />
								</f:facet>
								<h:outputText value="#{intraManager.intra.prospect.societe}" />
							</rich:column>

							<rich:column>
								<f:facet name="header">
									<h:outputText value="#{messages['prospect.com']}" />
								</f:facet>
								<h:outputText
									value="#{intraManager.intra.prospect.prospectDetail.commercial}" />
							</rich:column>
							<rich:column>
								<f:facet name="header">
									<h:outputText value="Durée souhaitée" />
								</f:facet>
								<h:outputText value="#{intraReferenceSpe.referenceSpe.duree}" />
							</rich:column>
							<rich:column>
								<f:facet name="header">
									<h:outputText value="Dates souhaitées" />
								</f:facet>
								<center>
									<h:outputText value="#{intraReferenceSpe.referenceSpe.session}"
										style="width:120px" />
								</center>
							</rich:column>
							<rich:column>
								<f:facet name="header">
									<h:outputText value="#{messages['prospect.reference']}" />
								</f:facet>
								<h:outputText value="Spé" />
							</rich:column>
							<rich:column>
								<f:facet name="header">
									<h:outputText value="#{messages['prospect.libelleFormation']}" />
								</f:facet>
								<h:outputText value="#{intraReferenceSpe.referenceSpe.libelle}" />
							</rich:column>
							<rich:column>
								<f:facet name="header">
									<h:outputText value="Nb part." />
								</f:facet>
								<center>
									<h:outputText
										value="#{intraReferenceSpe.referenceSpe.participant}"
										style="width:30px" />
								</center>
							</rich:column>
							<rich:column>
								<f:facet name="header">
									<h:outputText value="#{messages['prospect.lieu']}" />
								</f:facet>
								<h:outputText
									value="#{intraManager.intra.prospect.prospectDetail.lieu}"
									rendered="#{empty intraManager.intra.prospect.ville}" />
								<h:outputText value="#{intraManager.intra.prospect.ville}"
									rendered="#{!empty intraManager.intra.prospect.ville}" />
							</rich:column>
							<rich:column>
								<f:facet name="header">
									<h:outputText value="Intervenant(s)" />
								</f:facet>
								<center>
									<rich:dataTable value="#{intraReferenceSpe.intervenants}"
										var="intervenant" rowKeyVar="index" style="width:300px">
										<rich:column>
											<f:facet name="header">
												<h:outputText value="Nom - Prénom" />
											</f:facet>
											<h:outputText
												value="#{intervenant.intervenant.nom} - #{intervenant.intervenant.prenom}" />
										</rich:column>
										<rich:column>
											<f:facet name="header">
												<h:outputText value="Tarif" />
											</f:facet>
											<h:outputText value="#{intervenant.tarif}">
												<f:convertNumber currencySymbol="€" type="currency"
													locale="FR" />
											</h:outputText>
										</rich:column>
										<rich:column>
											<f:facet name="header">
												<h:outputText value="Note" />
											</f:facet>
											<h:outputText value="#{intervenant.note}" />
										</rich:column>
										<rich:column>
											<f:facet name="header">
												<h:outputText value="Retenu" />
											</f:facet>
											<center>
												<h:outputText value="Oui"
													rendered="#{intervenant.favori == 1}" />
												<h:outputText value="Non"
													rendered="#{intervenant.favori == 0}" />
											</center>
										</rich:column>
									</rich:dataTable>
								</center>
							</rich:column>
						</rich:dataTable>
					</a:outputPanel>
				</center>
			</rich:panel>
			<br />
			<rich:panel header="Retour commercial"
				rendered="#{ST_INTRA_ANNULE.equals(intraManager.intra.statutIntra)}">
				<a:outputPanel>
					<s:decorate template="../layout/display.xhtml" style="width:500px;">
						<ui:define name="label">
							<h:outputText value="#{messages['prospect.raisonPerte']}" />
						</ui:define>
						<h:outputText
							value="#{intraManager.intra.prospect.prospectDetail.raisonPerte}" />
					</s:decorate>
				</a:outputPanel>
			</rich:panel>
			<br />
			<rich:panel header="Note perso">
				<center>
					<rich:dataTable value="#{intraManager.messages}" var="message"
						rowKeyVar="index">
						<rich:column>
							<f:facet name="header">
								<h:outputText value="Message n°" />
							</f:facet>
							<center>
								<h:outputText value="#{index+1}" />
							</center>
							<f:facet name="footer">
								<h:outputText value="Message n°" />
							</f:facet>
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{messages['historique.date']}" />
							</f:facet>
							<h:outputText value="#{message.date}">
								<s:convertDateTime type="both" />
							</h:outputText>
							<f:facet name="footer">
								<h:outputText value="#{messages['historique.date']}" />
							</f:facet>
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{messages['message.emetteur']}" />
							</f:facet>
							<h:outputText value="#{message.account.nomComplet}" />
							<f:facet name="footer">
								<h:outputText value="#{messages['message.emetteur']}" />
							</f:facet>
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText
									value="#{messages['historique.FormationCommentEvent']}" />
							</f:facet>
							<h:outputText value="#{message.libelle}" />
							<f:facet name="footer">
								<h:outputText
									value="#{messages['historique.FormationCommentEvent']}" />
							</f:facet>
						</rich:column>
					</rich:dataTable>
				</center>
			</rich:panel>
		</rich:tab>
		<rich:tab header="Logistique" onheaderclick="changePage('page4')">
			<table border="0" cellspacing="3">
				<tr>
					<td><s:decorate template="../layout/display.xhtml"
							style="width:500px;">
							<ui:define name="label">
								<h:outputText value="Coordonnées contact support" />
							</ui:define>
							<h:outputText
								value="#{intraManager.intra.coordonneesContactsupport}" />
						</s:decorate></td>
					<td><s:decorate template="../layout/display.xhtml"
							style="width:500px;">
							<ui:define name="label">
								<h:outputText value="Horaire de formation" />
							</ui:define>
							<h:outputText
								value="#{intraManager.intra.heureDeb} - #{intraManager.intra.heureFin}"
								rendered="#{!empty intraManager.intra.heureDeb or empty intraManager.intra.heureFin}" />
							<h:outputText value="N/C"
								rendered="#{empty intraManager.intra.heureDeb and empty intraManager.intra.heureFin}" />
						</s:decorate></td>
				</tr>
			</table>
			<rich:collapsiblePanel header="Adresse : " expanded="true"
				switchType="client">
				<table border="0" cellspacing="0">
					<tr>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:600px;">
								<ui:define name="label">
									<h:outputText value="#{messages['prospect.nomEntreprise']}" />
								</ui:define>
								<h:outputText value="#{intraManager.intra.prospect.societe}" />
							</s:decorate></td>
					</tr>
					<tr>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:600px;">
								<ui:define name="label">
									<h:outputText value="#{messages['prospect.adresse']}" />
								</ui:define>
								<h:outputText value="#{intraManager.intra.prospect.adresse}" />
							</s:decorate></td>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:400px;">
								<ui:define name="label">
									<h:outputText value="#{messages['prospect.ville']}" />
								</ui:define>
								<h:outputText value="#{intraManager.intra.prospect.ville}" />
							</s:decorate></td>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:300px;">
								<ui:define name="label">
									<h:outputText value="#{messages['prospect.cp']}" />
								</ui:define>
								<h:outputText value="#{intraManager.intra.prospect.cp}" />
							</s:decorate></td>
					</tr>
					<tr>
						<td><s:decorate template="../layout/display.xhtml"
								style="width:400px;">
								<ui:define name="label">
									<h:outputText value="#{messages['prospect.pays']}" />
								</ui:define>
								<h:outputText value="#{intraManager.intra.prospect.pays}" />
							</s:decorate></td>
					</tr>
				</table>
			</rich:collapsiblePanel>
		</rich:tab>
		<rich:tab header="Historique">
			<center>
				<rich:dataTable value="#{intraManager.historique}" var="event"
					rowKeyVar="index">
					<rich:column>
						<f:facet name="header">
							<h:outputText value="Opération n°" />
						</f:facet>
						<center>
							<h:outputText value="#{index+1}" />
						</center>
						<f:facet name="footer">
							<h:outputText value="Opération n°" />
						</f:facet>
					</rich:column>
					<rich:column>
						<f:facet name="header">
							<h:outputText value="#{messages['historique.date']}" />
						</f:facet>
						<h:outputText value="#{event.date}" />
						<f:facet name="footer">
							<h:outputText value="#{messages['historique.date']}" />
						</f:facet>
					</rich:column>
					<rich:column>
						<f:facet name="header">
							<h:outputText value="#{messages['historique.acteur']}" />
						</f:facet>
						<h:outputText value="#{event.account.nomComplet}" />
						<f:facet name="footer">
							<h:outputText value="#{messages['historique.acteur']}" />
						</f:facet>
					</rich:column>
					<rich:column>
						<f:facet name="header">
							<h:outputText value="#{messages['historique.event']}" />
						</f:facet>
						<h:outputText value="#{event.message}" />
						<f:facet name="footer">
							<h:outputText value="#{messages['historique.event']}" />
						</f:facet>
					</rich:column>
					<rich:column
						style="background-color:#{intraManager.coloriage(event.statutIntra)}">
						<f:facet name="header">
							<h:outputText value="#{messages['intra.statut']}" />
						</f:facet>
						<center>
							<b><h:outputText value="#{messages[event.statutIntra]}" /></b>
						</center>
						<f:facet name="footer">
							<h:outputText value="#{messages['intra.statut']}" />
						</f:facet>
					</rich:column>
				</rich:dataTable>
			</center>
		</rich:tab>
		<center>
			<a:status id="spinner">
				<f:facet name="stop" />
				<f:facet name="start">
					<h:graphicImage value="/img/load.gif" alt="Chargement ..."
						style="width:2%" />
				</f:facet>
			</a:status>
		</center>
		<br />
		<a4j:region id="visuModeForm">
			<center>
				<a4j:commandButton value="Editer"
					action="#{intraManager.setEditMode()}" oncomplete="loadPage();"
					render="intraPanel,editFormIntra" style="width:100px;height:30px;" />
				&nbsp;&nbsp;
				<a4j:commandButton value="Annuler"
					onclick="#{rich:component('popupModifIntra')}.hide()"
					style="width:100px;height:30px;" />
			</center>
		</a4j:region>
	</rich:tabPanel>


</ui:composition>